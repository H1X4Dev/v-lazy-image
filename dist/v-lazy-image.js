(function(e,s){typeof exports=="object"&&typeof module!="undefined"?module.exports=s(require("vue")):typeof define=="function"&&define.amd?define(["vue"],s):(e=typeof globalThis!="undefined"?globalThis:e||self,e.VLazyImage=s(e.Vue))})(this,function(e){"use strict";var s={props:{src:{type:String,required:!0},srcPlaceholder:{type:String,default:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},srcset:{type:String},intersectionOptions:{type:Object,default:()=>({})},usePicture:{type:Boolean,default:!1}},inheritAttrs:!1,setup(r,{attrs:c,slots:d,emit:o}){const n=e.ref(null),t=e.reactive({observer:null,intersected:!1,loaded:!1}),l=e.computed(()=>t.intersected&&r.src?r.src:r.srcPlaceholder),u=e.computed(()=>t.intersected&&r.srcset?r.srcset:!1),a=()=>{n.value&&n.value.getAttribute("src")!==r.srcPlaceholder&&(t.loaded=!0,o("load",n.value))},A=()=>o("error",n.value);return e.onMounted(()=>{"IntersectionObserver"in window&&(t.observer=new IntersectionObserver(i=>{i[0].isIntersecting&&(t.intersected=!0,t.observer.disconnect(),o("intersect"))},r.intersectionOptions),t.observer.observe(n.value))}),e.onBeforeUnmount(()=>{"IntersectionObserver"in window&&t.observer&&t.observer.disconnect()}),()=>{const i=e.h("img",{ref:n,src:l.value,srcset:u.value||null,...c,class:[c.class,"v-lazy-image",{"v-lazy-image-loaded":t.loaded}],onLoad:a,onError:A});return r.usePicture?e.h("picture",{ref:n,onLoad:a},t.intersected?[d.default,i]:[i]):i}}};return s});
